# Проект по предсказанию употребления наркотиков
### [English](https://github.com/cactus-tim/ml_project/blob/main/Readme.eng.md)

## Обзор
***

Этот проект, проведенный в рамках учебного процесса на 2-м курсе ВШЭ СПб, направлен на предсказание вероятности употребления наркотиков для отдельных индивидов на основе психологических тестов, уровня образования и расы. Основное внимание уделяется прогнозированию вероятности употребления как в прошлом, так и в будущем.

### [Презентация](https://docs.google.com/presentation/d/12mVAZwc1BSGk0QIwYD6lov-KaRS65YofiZYW_E_o3bw/edit#slide=id.g2e2ae930e05_0_13)

### [Датасет](https://www.kaggle.com/datasets/mexwell/drug-consumption-classification/data)

## Цель
***

Основная цель проекта - предсказать вероятность употребления наркотиков для конкретного индивида на основе различных психологических и демографических факторов.

## Методология
***

### Выбор модели

Для предсказания была использована модель CatBoostClassifier от Yandex, поскольку она отлично справляется с обработкой категориальных признаков.

### Обучение модели

Для каждого предсказываемого наркотика была обучена своя модель. В качестве метрики был выбран precision, так как в данном случае необходимо минимизировать количество ложноположительных ответов.

### Итоговая точность

- **Cannabis**: 0.8906
- **Coke**: 0.6602
- **Ecstasy**: 0.6946
- **LSD**: 0.6371
- **Mushrooms**: 0.6961

## Процесс исследования
***

Весь процесс исследования задокументирован в блокноте. Итогом проектной деятельности стал телеграм-бот, который проводит опрос и просит пройти три теста для выявления склонности к употреблению наркотиков.

## Контрольная группа
***

После опроса контрольной группы было выявлено, что для большей части людей высоковероятно употребление каннабиса. Это может быть связано с тем, что в учебной выборке было 20% людей, не употреблявших каннабис, что могло привести к переобучению модели. Также это может быть связано с отношением к каннабису как к легкому наркотику и открытостью людей к такому опыту.

## Другие наркотики
***

Для остальных наркотиков вероятность употребления была выше 0.5, если человек пробовал два из четырех других наркотиков (не учитывая каннабис). Это связано с психотипом личности.

## Минимизация ложноположительных ответов
***

Для людей из контрольной группы без опыта употребления наркотиков модель чаще всего не ошибалась, что свидетельствует о том, что задача минимизации ложноположительных ответов была выполнена успешно.


Эти результаты и выводы позволяют предположить успешность использованного подхода, а также необходимость дальнейшего исследования и улучшения модели для повышения точности предсказаний.

## Запуск
***

Скачать зависимости питона:

`pip install -r requirements.txt`

Локальный запуск:

`python3 bot.py`
